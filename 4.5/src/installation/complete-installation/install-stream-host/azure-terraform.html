<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Stream Host Azure Terraform | XMPro </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Stream Host Azure Terraform | XMPro ">
      <meta name="description" content="XMPro official documentation - Learn how to use XMPro&#39;s intelligent digital twin suite for real-time operational intelligence and automated decision-making.">
      
      <link rel="icon" href="../../../../images/favicon.png">
      <link rel="stylesheet" href="../../../../public/docfx.min.css">
      <link rel="stylesheet" href="../../../../public/main.css">
      <meta name="docfx:navrel" content="../../../../toc.html">
      <meta name="docfx:tocrel" content="../../../toc.html">
      
      <meta name="docfx:rel" content="../../../../">
      
      
      <meta name="docfx:docurl" content="https://xmpro.visualstudio.com/XMPro%20Development/_git/xmpro-development?path=docs/src/installation/complete-installation/install-stream-host/azure-terraform.md&amp;version=GBrelease-4.5.3&amp;line=1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../../../../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../../../index.html">
            <img id="logo" class="svg" src="../../../../images/logo-light.png" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="stream-host-azure-terraform">Stream Host Azure Terraform</h1>

<h2 id="introduction">Introduction</h2>
<p>This guide covers deploying XMPro Stream Host using the Azure Terraform module. You can deploy Stream Host either as part of the full XMPro platform or as a standalone container that connects to an existing Data Stream Designer instance.</p>
<h2 id="prerequisites">Prerequisites</h2>
<p>Ensure you have completed the <a href="../../azure-terraform-preparation.html">Azure Terraform Prerequisites</a> which covers:</p>
<ul>
<li>Terraform installation</li>
<li>Azure CLI setup and authentication</li>
<li>Azure subscription requirements</li>
</ul>
<h3 id="for-standalone-deployment">For Standalone Deployment</h3>
<ul>
<li>An existing XMPro Data Stream Designer instance</li>
<li>Collection ID and Secret from your DS instance</li>
</ul>
<h3 id="sizing-recommendations">Sizing Recommendations</h3>
<p>The Terraform module allows you to configure Stream Host resources based on your workload:</p>
<table>
<thead>
<tr>
<th>Workload Type</th>
<th>CPU Cores</th>
<th>Memory (GB)</th>
<th>Use Case</th>
</tr>
</thead>
<tbody>
<tr>
<td>Small (Default)</td>
<td>1</td>
<td>4</td>
<td>Light data processing, few agents</td>
</tr>
<tr>
<td>Medium</td>
<td>2</td>
<td>8</td>
<td>Moderate workloads, multiple agents</td>
</tr>
<tr>
<td>Large</td>
<td>4</td>
<td>16</td>
<td>Heavy processing, complex transformations</td>
</tr>
</tbody>
</table>
<p><strong>Configuration Limits:</strong></p>
<ul>
<li>CPU: 0.25 to 4 cores</li>
<li>Memory: 0.5 to 16 GB</li>
</ul>
<div class="TIP">
<h5>Tip</h5>
<p>Start with the default configuration (1 CPU, 4 GB RAM) and scale up based on monitoring metrics.</p>
</div>
<h2 id="deployment-options">Deployment Options</h2>
<h3 id="option-1-with-full-xmpro-platform">Option 1: With Full XMPro Platform</h3>
<p>When deploying the complete XMPro platform, Stream Host is automatically included. See the <a href="https://github.com/XMPro/terraform-xmpro-azure/tree/main/examples/basic">basic example</a> in the terraform-xmpro-azure repository.</p>
<h3 id="option-2-standalone-stream-host">Option 2: Standalone Stream Host</h3>
<p>To deploy only Stream Host to connect to an existing DS instance, use the dedicated <a href="https://github.com/XMPro/terraform-xmpro-azure/tree/main/examples/stream-host">Stream Host example</a> from the terraform-xmpro-azure repository.</p>
<p>The example includes:</p>
<ul>
<li>Complete Terraform configuration files</li>
<li>Variable definitions with defaults</li>
<li>Step-by-step deployment instructions</li>
<li>Troubleshooting guide</li>
</ul>
<h2 id="quick-start">Quick Start</h2>
<ol>
<li><p><strong>Clone the repository</strong></p>
<pre><code class="lang-bash">git clone https://github.com/XMPro/terraform-xmpro-azure.git
cd terraform-xmpro-azure/examples/stream-host
</code></pre>
</li>
<li><p><strong>Configure your deployment</strong></p>
<pre><code class="lang-bash"># Copy the example variables file
# Linux/Mac:
cp terraform.tfvars.example terraform.tfvars

# Windows:
copy terraform.tfvars.example terraform.tfvars

# Edit with your specific values
nano terraform.tfvars   # Linux/Mac
notepad terraform.tfvars # Windows
</code></pre>
</li>
<li><p><strong>Deploy</strong></p>
<pre><code class="lang-bash">terraform init
terraform plan
terraform apply
</code></pre>
</li>
</ol>
<p>For detailed configuration options and examples, refer to the <a href="https://github.com/XMPro/terraform-xmpro-azure/blob/main/examples/stream-host/README.md">Stream Host example README</a>.</p>
<h2 id="getting-collection-credentials">Getting Collection Credentials</h2>
<p>For standalone deployments, you need collection credentials from Data Stream Designer:</p>
<ol>
<li>Open your XMPro Data Stream Designer</li>
<li>Navigate to <strong>Collections</strong></li>
<li>Select or create a collection for the Stream Host</li>
<li>Go to <strong>Settings</strong> tab</li>
<li>Copy the <strong>Collection ID</strong> and <strong>Collection Secret</strong></li>
</ol>
<p><img src="../../../images/image-1489.png" alt="Collection details in Data Stream Designer"></p>
<h2 id="key-configuration-variables">Key Configuration Variables</h2>
<p>The Stream Host module supports various configuration options. Here are the most important ones:</p>
<h3 id="resource-allocation">Resource Allocation</h3>
<ul>
<li><strong>stream_host_cpu</strong>: CPU cores (0.25 to 4)</li>
<li><strong>stream_host_memory</strong>: Memory in GB (0.5 to 16)</li>
</ul>
<h3 id="docker-image-variants">Docker Image Variants</h3>
<ul>
<li><strong>stream_host_variant</strong>: Choose the Docker image variant (default: <code>&quot;&quot;</code> which is the same as <code>&quot;bookworm-slim&quot;</code>, other options: <code>&quot;bookworm-slim-python3.12&quot;</code>, <code>&quot;alpine3.21&quot;</code>)</li>
</ul>
<h3 id="environment-variables">Environment Variables</h3>
<ul>
<li><strong>SH_PIP_MODULES</strong>: Python packages to install (only available with <code>bookworm-slim-python3.12</code> variant)</li>
<li><strong>ADDITIONAL_INSTALLS</strong>: System packages to install (works with all variants - APT for Debian, APK for Alpine)</li>
<li><strong>Custom variables</strong>: Any additional environment variables (works with all variants)</li>
</ul>
<p>For a complete list of variables and configuration options, see the <a href="https://github.com/XMPro/terraform-xmpro-azure/tree/main/modules/stream-host-container">module documentation</a>.</p>
<h2 id="common-configuration-examples">Common Configuration Examples</h2>
<h3 id="python-package-installation">Python Package Installation</h3>
<p>Install Python packages for data processing:</p>
<pre><code class="lang-bash"># In your terraform.tfvars
# First, specify the Python variant
stream_host_variant = &quot;bookworm-slim-python3.12&quot;

# Then configure pip packages (only works with Python variant)
environment_variables = {
  &quot;SH_PIP_MODULES&quot; = &quot;pandas numpy scikit-learn&quot;
}
</code></pre>
<h3 id="system-dependencies">System Dependencies</h3>
<p>Install additional system packages:</p>
<pre><code class="lang-bash"># In your terraform.tfvars
# Use Python variant if you need both Python and system packages
stream_host_variant = &quot;bookworm-slim-python3.12&quot;

environment_variables = {
  &quot;ADDITIONAL_INSTALLS&quot; = &quot;git build-essential python3-dev&quot;  # Works with all variants
  &quot;SH_PIP_MODULES&quot;     = &quot;pandas numpy scikit-learn tensorflow&quot;  # Only works with Python variant
}
</code></pre>
<div class="IMPORTANT">
<h5>Important</h5>
<p>The <code>SH_PIP_MODULES</code> and <code>PIP_REQUIREMENTS_PATH</code> environment variables only work with the <code>bookworm-slim-python3.12</code> variant. The <code>ADDITIONAL_INSTALLS</code> variable works with all variants (APT for Debian variants, APK for Alpine). See <a href="docker.html#available-variants">Docker Variants documentation</a> for details.</p>
</div>
<h3 id="resource-scaling">Resource Scaling</h3>
<p>Adjust resources based on your workload requirements:</p>
<pre><code class="lang-bash"># In your terraform.tfvars
# Medium workload
stream_host_cpu    = 2
stream_host_memory = 8

# Large workload
stream_host_cpu    = 4
stream_host_memory = 16
</code></pre>
<p>For more advanced configurations including:</p>
<ul>
<li>Volume mounts</li>
<li>Monitoring integration</li>
<li>Multiple Stream Host deployments</li>
<li>Custom networking</li>
</ul>
<p>See the comprehensive examples in the <a href="https://github.com/XMPro/terraform-xmpro-azure/tree/main/examples/stream-host">terraform-xmpro-azure repository</a>.</p>
<h2 id="troubleshooting">Troubleshooting</h2>
<h3 id="stream-host-not-connecting">Stream Host Not Connecting</h3>
<p>If the Stream Host doesn't appear in Data Stream Designer:</p>
<ol>
<li><p><strong>Check container logs</strong></p>
<pre><code class="lang-bash">az container logs --resource-group &lt;rg-name&gt; --name &lt;container-name&gt;
</code></pre>
</li>
<li><p><strong>Verify environment variables</strong></p>
<pre><code class="lang-bash">az container show --resource-group &lt;rg-name&gt; --name &lt;container-name&gt; --query &quot;containers[0].environmentVariables&quot;
</code></pre>
</li>
<li><p><strong>Check network connectivity</strong></p>
<ul>
<li>Ensure DS server URL is accessible</li>
<li>Verify no firewall blocking outbound connections</li>
</ul>
</li>
</ol>
<h3 id="other-common-issues">Other Common Issues</h3>
<p>For comprehensive troubleshooting including:</p>
<ul>
<li>Python package installation failures (ensure you're using <code>bookworm-slim-python3.12</code> variant)</li>
<li>Resource allocation problems</li>
<li>Network connectivity issues</li>
<li>Container restart loops</li>
</ul>
<p>Refer to the <a href="https://github.com/XMPro/terraform-xmpro-azure/blob/main/examples/stream-host/README.md#troubleshooting">troubleshooting section</a> in the Stream Host example.</p>
<h2 id="best-practices">Best Practices</h2>
<ol>
<li><p><strong>Start Simple</strong></p>
<ul>
<li>Use the example configuration as a starting point</li>
<li>Test with minimal configuration first</li>
<li>Add complexity incrementally</li>
</ul>
</li>
<li><p><strong>Version Control</strong></p>
<ul>
<li>Store your Terraform configurations in version control</li>
<li>Use <code>.gitignore</code> for sensitive files</li>
<li>Tag deployments for easy rollback</li>
</ul>
</li>
<li><p><strong>Security</strong></p>
<ul>
<li>Never commit credentials to version control</li>
<li>Use Azure Key Vault for secrets</li>
<li>Enable managed identities where possible</li>
</ul>
</li>
<li><p><strong>Monitoring</strong></p>
<ul>
<li>Always configure Application Insights</li>
<li>Set up alerts for critical metrics</li>
<li>Review logs regularly</li>
</ul>
</li>
</ol>
<h2 id="complete-example-repository">Complete Example Repository</h2>
<p>All the code examples, configuration files, and detailed documentation for Stream Host deployment are available in the <a href="https://github.com/XMPro/terraform-xmpro-azure">terraform-xmpro-azure</a> repository:</p>
<ul>
<li><strong><a href="https://github.com/XMPro/terraform-xmpro-azure/tree/main/examples/stream-host">Stream Host Example</a></strong> - Complete standalone deployment</li>
<li><strong><a href="https://github.com/XMPro/terraform-xmpro-azure/tree/main/examples/basic">Basic Platform Example</a></strong> - Full platform with Stream Host</li>
<li><strong><a href="https://github.com/XMPro/terraform-xmpro-azure/tree/main/modules/stream-host-container">Module Documentation</a></strong> - Detailed variable reference</li>
</ul>
<h2 id="related-documentation">Related Documentation</h2>
<ul>
<li><a href="docker.html">Stream Host Docker Installation</a> - For standalone Docker deployments</li>
<li><a href="../../../concepts/collection.html">Collection and Stream Host Concepts</a> - Understanding Stream Host architecture</li>
<li><a href="../../deployment/azure-terraform/index.html">Azure Terraform Deployment Guide</a> - Complete platform deployment guide</li>
</ul>
<h2 id="next-steps">Next Steps</h2>
<p>After deployment:</p>
<ol>
<li>Access Data Stream Designer to verify Stream Host connection</li>
<li>Create your first data stream</li>
<li>Configure agents and connectors</li>
<li>Monitor performance and adjust resources as needed</li>
</ol>


  <div class="last-modified">
    <hr />
    <p><small><em>Last modified: August 26, 2025</em></small></p>
  </div>
</article>



      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          Copyright © 2025 XMPro. All rights reserved.
        </div>
      </div>
    </footer>
  </body>
</html>
